# 📋 TaskFlow: Система очереди задач - Полный обзор

## 🎯 Что нового?

TaskFlow теперь поддерживает **систему очереди задач** - мощный инструмент для организации последовательного выполнения задач с автоматическим управлением статусами и приоритетами.

## 🆕 Новые возможности

### 1. Управление очередью

#### Добавление в очередь

- Правый клик → "Добавить в очередь"
- Автоматическая нумерация позиций
- Сохранение в Markdown файле

#### Удаление из очереди

- Правый клик → "Удалить из очереди"
- Автоматическое обновление позиций
- Задача остается в общем списке

#### Изменение порядка

- Перемещение задач вверх/вниз
- Простой ввод новой позиции
- Мгновенное обновление

### 2. Автоматизация выполнения

#### Запуск следующей задачи

```
Кнопка ▶️ → Автоматический старт первой неначатой задачи
```

#### Умное переключение

```
"Завершить и начать следующую" →
  ✅ Текущая завершена
  ▶️ Следующая запущена
  🔄 Статусы обновлены
```

### 3. Визуальное представление

#### Новая панель "Очередь задач"

```
TaskFlow Explorer
├── 📋 Задачи
├── 📋 Очередь задач  ← НОВАЯ!
└── 📁 Категории
```

#### Индикаторы в интерфейсе

- **📋 #1** - Первая в очереди
- **📋 #2** - Вторая в очереди
- **📋 #N** - N-ная в очереди

### 4. Команды

| Команда               | Горячая клавиша | Описание                        |
| --------------------- | --------------- | ------------------------------- |
| Добавить в очередь    | Настраиваемая   | Добавить задачу в конец очереди |
| Удалить из очереди    | Настраиваемая   | Убрать задачу из очереди        |
| Переместить в очереди | Настраиваемая   | Изменить позицию задачи         |
| Начать следующую      | Настраиваемая   | Запустить первую задачу         |
| Завершить и начать    | Настраиваемая   | Комбо: завершить + начать       |
| Показать очередь      | Настраиваемая   | Быстрый просмотр очереди        |

## 📐 Архитектура

### Обновленная модель данных

```typescript
interface Task {
  id: string;
  title: string;
  // ... другие поля
  queuePosition?: number; // ← НОВОЕ ПОЛЕ
}
```

### Новые методы TaskManager

```typescript
class TaskManager {
  // Получение задач в очереди
  getQueuedTasks(): Task[];

  // Управление очередью
  addToQueue(taskId: string): Promise<void>;
  removeFromQueue(taskId: string): Promise<void>;
  moveInQueue(taskId: string, newPosition: number): Promise<void>;

  // Автоматизация
  startNextInQueue(): Promise<Task | null>;
  completeAndStartNext(taskId: string): Promise<Task | null>;
}
```

### Новый провайдер QueueTreeProvider

```typescript
class QueueTreeProvider implements TreeDataProvider<TaskTreeItem> {
  // Отображение только задач в очереди
  // Автоматическое обновление при изменениях
  // Сортировка по позиции
}
```

## 📝 Формат Markdown

### До

```markdown
- [ ] Моя задача [Высокий] Срок: 2025-12-31 @john
```

### После (в очереди)

```markdown
- [ ] Моя задача [Высокий] Срок: 2025-12-31 @john Очередь: 1
```

### Парсинг и сериализация

- Автоматическое извлечение `Очередь: N`
- Сохранение позиции при редактировании
- Обновление при изменении порядка

## 🔄 Workflow примеры

### Ежедневное планирование

```
Утро (09:00):
├── Просмотр всех задач
├── Выбор 5 приоритетных задач
├── Добавление в очередь по важности
└── Запуск первой задачи ▶️

В течение дня:
├── Работа над текущей задачей
├── Завершить и начать следующую ✅
└── Повторить до конца очереди

Вечер (18:00):
├── Проверка прогресса
├── Обновление оставшихся задач
└── Планирование очереди на завтра
```

### Разработка функции

```
Feature: Система уведомлений

1. Проектирование       [Высокий]  Очередь: 1  📋 ← Текущая
2. Реализация API       [Высокий]  Очередь: 2  📋
3. Реализация UI        [Средний]  Очередь: 3  📋
4. Интеграция          [Средний]  Очередь: 4  📋
5. Тестирование        [Высокий]  Очередь: 5  📋
6. Документация        [Низкий]   Очередь: 6  📋

Процесс:
├── Начать задачу 1 → Статус: 🔄 В процессе
├── Завершить задачу 1 → Статус: ✅ Завершено
├── Автостарт задачи 2 → Статус: 🔄 В процессе
└── Повторить...
```

### Спринт команды

```
Команда из 3 человек:

Alice:
├── Задача A1  Очередь: 1  @alice
├── Задача A2  Очередь: 2  @alice
└── Задача A3  Очередь: 3  @alice

Bob:
├── Задача B1  Очередь: 1  @bob
├── Задача B2  Очередь: 2  @bob
└── Задача B3  Очередь: 3  @bob

Charlie:
├── Задача C1  Очередь: 1  @charlie
└── Задача C2  Очередь: 2  @charlie

Каждый работает со своей очередью параллельно!
```

## 🎨 UI/UX улучшения

### Визуальная панель очереди

```
📋 Очередь задач                    [▶️] [📋]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  📋 #1 🔄 Реализовать API [Высокий]
       └─ 2/4 подзадач

  📋 #2 ⏳ Написать тесты [Средний]
       └─ 0/3 подзадач

  📋 #3 ⏳ Создать документацию [Низкий]
       └─ описание задачи
```

### Контекстное меню задачи

```
Правый клик на задаче:
├── Редактировать задачу           ✏️
├── Переключить статус             ☑️
├── ─────────────────────────────
├── Добавить в очередь             ➕
├── Удалить из очереди             ➖
├── Переместить в очереди          ⬍⬍
├── Завершить и начать следующую   ✅▶️
├── ─────────────────────────────
├── Сгенерировать код с Copilot    ✨
└── Удалить задачу                 🗑️
```

### Tooltip расширенный

```
Наведение на задачу в очереди:

┌─────────────────────────────────┐
│ Реализовать API авторизации     │
│                                 │
│ Статус: В процессе              │
│ Приоритет: Высокий              │
│ Категория: Бэкенд               │
│ Позиция в очереди: 1            │ ← НОВОЕ!
│ Срок: 31.12.2025               │
│ Исполнитель: @alice             │
│                                 │
│ Прогресс: 2/4 (50%)            │
│                                 │
│ Описание:                       │
│ Создать REST API для входа...   │
└─────────────────────────────────┘
```

## 📊 Статистика и аналитика

### Информация о очереди

```typescript
const queueStats = {
  total: 5, // Всего задач в очереди
  inProgress: 1, // В процессе
  pending: 4, // Ожидают
  completed: 0, // Завершено (вне очереди)
  averagePosition: 3, // Средняя позиция
  nextTask: {
    // Следующая задача
    title: "Написать тесты",
    priority: "Средний",
    position: 2,
  },
};
```

## 🔌 API для расширений

```typescript
// Добавить задачу в очередь программно
await vscode.commands.executeCommand("taskflow.addToQueue", taskTreeItem);

// Получить список задач в очереди
const queuedTasks = taskManager.getQueuedTasks();

// Начать следующую задачу
await vscode.commands.executeCommand("taskflow.startNextInQueue");

// Переместить задачу
await taskManager.moveInQueue(taskId, newPosition);
```

## 📚 Документация

Созданы новые документы:

1. **QUEUE_GUIDE.md** (11KB)

   - Полное руководство по использованию
   - Сценарии применения
   - FAQ и примеры

2. **QUEUE_CHEATSHEET.md** (5KB)

   - Быстрая справка по командам
   - Горячие клавиши
   - Советы и трюки

3. Обновлен **README.md**

   - Раздел о очереди задач
   - Новые команды в таблице
   - Ссылка на QUEUE_GUIDE.md

4. Обновлен **CHANGELOG.md**
   - Версия [Unreleased]
   - Все новые функции
   - 10 новых возможностей

## 🧪 Тестирование

Рекомендуемый процесс тестирования:

### Базовый функционал

```
✓ Добавить задачу в очередь
✓ Проверить автоматическую нумерацию
✓ Удалить задачу из очереди
✓ Проверить обновление позиций
✓ Переместить задачу в очереди
```

### Автоматизация

```
✓ Запустить следующую задачу
✓ Проверить смену статуса на "В процессе"
✓ Завершить задачу и начать следующую
✓ Проверить удаление из очереди при завершении
✓ Попробовать с пустой очередью
```

### UI/UX

```
✓ Открыть панель "Очередь задач"
✓ Проверить отображение позиций
✓ Контекстное меню на задаче
✓ Tooltip с информацией о позиции
✓ Кнопки в панели инструментов
```

### Markdown

```
✓ Создать задачу вручную с "Очередь: N"
✓ Проверить парсинг при загрузке
✓ Изменить позицию и проверить файл
✓ Удалить из очереди и проверить файл
✓ Проверить синхронизацию при внешних изменениях
```

## 🚀 Быстрый старт

### За 2 минуты

```bash
# 1. Перезагрузите расширение
Ctrl+R в Extension Development Host

# 2. Создайте задачи
Ctrl+Shift+P → "TaskFlow: Добавить новую задачу"

# 3. Добавьте в очередь
Правый клик → "Добавить в очередь"

# 4. Начните работу
Кнопка ▶️ в панели "Очередь задач"

# 5. Завершите задачу
Правый клик → "Завершить и начать следующую"

✅ Готово!
```

## 💡 Продвинутые техники

### Приоритизация очереди

```typescript
// Автоматическая сортировка по приоритету
const sortedQueue = queuedTasks.sort((a, b) => {
  const priorityOrder = {
    Высокий: 3,
    Средний: 2,
    Низкий: 1,
  };
  return priorityOrder[b.priority] - priorityOrder[a.priority];
});
```

### Условные переходы

```typescript
// Начать следующую только если прошлая завершена
if (currentTask.status === TaskStatus.Completed) {
  await taskManager.completeAndStartNext(currentTask.id);
}
```

### Интеграция с CI/CD

```yaml
# GitHub Actions
- name: Update TaskFlow Queue
  run: |
    # Автоматическое обновление очереди при деплое
    # Перемещение задач "Deploy" в начало очереди
```

## 🎓 Обучающие материалы

- [📋 Полное руководство](QUEUE_GUIDE.md) - Все о работе с очередью
- [⚡ Шпаргалка](QUEUE_CHEATSHEET.md) - Быстрая справка
- [🚀 Быстрый старт](QUICK_START.md) - Начало работы
- [🏗️ Архитектура](ARCHITECTURE.md) - Технические детали

## 🔮 Будущие улучшения

- [ ] Множественные очереди (личная, командная, срочная)
- [ ] Условное выполнение (зависимости между задачами)
- [ ] Временные ограничения (time-boxing)
- [ ] Статистика производительности
- [ ] Экспорт очереди в календарь
- [ ] Интеграция с Jira/GitHub Issues
- [ ] Умные рекомендации по очередности

## 📞 Поддержка

Возникли вопросы? Нашли баг?

- 📖 Читайте [QUEUE_GUIDE.md](QUEUE_GUIDE.md)
- 🐛 Создайте Issue на GitHub
- 💬 Обсудите в Discussions

---

**Создано с ❤️ для эффективной работы разработчиков!**

_TaskFlow v0.2.0 (Unreleased) - Queue Management Update_
